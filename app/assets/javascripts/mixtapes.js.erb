$(document).ready(function () {
    $("#q").tokenInput("/searches/new.json", {
        tokenLimit: 1,
        onAdd: function(item){
            var items=item.name.split(': ')
            $("#tiny_id_field").val(item.id);
            $('#artist_field').val(items[0]);
            $('#title_field').val(items[1]);
            $('#create_song_submit').trigger('click');
            $('#q').tokenInput("remove", {id: item.id});
        }
    });
	
	// Return a helper with preserved width of cells
	var fixHelper = function(e, ui) {
		ui.children().each(function() {
			$(this).width($(this).width());
		});
		return ui;
	};

    $(document).on( 'click', 'button.remove', function(event){
        event.preventDefault();
        $(this).parent().parent().remove();
    });

    $('#mixtape_track_list tbody').sortable({
        handle:"button",
        axis:"y",
        cancel:'',
        helper: fixHelper
    }).disableSelection();
});

